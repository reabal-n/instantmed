# =============================================================================
# InstantMed Environment Variables Template
# =============================================================================
# Copy this file to .env.local for local development
# Configure in Vercel dashboard for production deployment
#
# SECURITY: Never commit .env.local or production credentials to version control
# =============================================================================

# -----------------------------------------------------------------------------
# Clerk Authentication (REQUIRED)
# -----------------------------------------------------------------------------
# Get these from: https://dashboard.clerk.com/last-active?path=api-keys
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=YOUR_PUBLISHABLE_KEY
CLERK_SECRET_KEY=YOUR_SECRET_KEY

# Clerk redirect URLs (using Account Portal)
NEXT_PUBLIC_CLERK_SIGN_IN_URL=https://accounts.your-domain.com/sign-in
NEXT_PUBLIC_CLERK_SIGN_UP_URL=https://accounts.your-domain.com/sign-up
NEXT_PUBLIC_CLERK_SIGN_IN_FALLBACK_REDIRECT_URL=/patient
NEXT_PUBLIC_CLERK_SIGN_UP_FALLBACK_REDIRECT_URL=/patient/onboarding

# Clerk Webhook Secret (for user sync to Supabase)
# Get from: Clerk Dashboard > Webhooks > Your webhook > Signing Secret
CLERK_WEBHOOK_SECRET=whsec_...

# -----------------------------------------------------------------------------
# Supabase Database (REQUIRED)
# -----------------------------------------------------------------------------
# Get these from: https://app.supabase.com/ > Project Settings > API
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# Connection Pooling (RECOMMENDED for production)
# Use pooler URL for better connection management under load
# Get from: Supabase Dashboard > Project Settings > Database > Connection Pooling
# Format: postgres://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres
# SUPABASE_POOLER_URL=postgres://...

# -----------------------------------------------------------------------------
# Stripe Payments (REQUIRED)
# -----------------------------------------------------------------------------
# Get these from: https://dashboard.stripe.com/apikeys
# IMPORTANT: Use test keys (pk_test_/sk_test_) for development
#            Use live keys (pk_live_/sk_live_) for production only
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_SECRET_KEY=sk_test_...

# Get webhook secret from: https://dashboard.stripe.com/webhooks
# Create webhook endpoint pointing to: https://your-domain.com/api/stripe/webhook
# Events to listen for: checkout.session.completed, checkout.session.expired
STRIPE_WEBHOOK_SECRET=whsec_...

# Stripe Price IDs (create these in Stripe Dashboard > Products)
# Use test prices (price_test_*) for development, live prices (price_*) for production
STRIPE_PRICE_MEDCERT=price_test_...
STRIPE_PRICE_MEDCERT_2DAY=price_test_...
STRIPE_PRICE_PRESCRIPTION=price_test_...
STRIPE_PRICE_CONSULT=price_test_...

# -----------------------------------------------------------------------------
# Application URL (REQUIRED)
# -----------------------------------------------------------------------------
# Local: http://localhost:3000
# Production: https://instantmed.com.au (or your actual domain)
NEXT_PUBLIC_APP_URL=http://localhost:3000

# -----------------------------------------------------------------------------
# Vercel AI Gateway (REQUIRED for AI features)
# -----------------------------------------------------------------------------
# Option A: API Key - Get from Vercel Dashboard > AI Gateway
# Option B: OIDC (automatic on Vercel deployments - no key needed)
# Used for: clinical note generation, decline reason drafting, chat intake
AI_GATEWAY_API_KEY=your_api_key_here

# -----------------------------------------------------------------------------
# Sentry Error Tracking (OPTIONAL - highly recommended for production)
# -----------------------------------------------------------------------------
# Get these from: https://sentry.io/
NEXT_PUBLIC_SENTRY_DSN=https://your-hash@sentry.io/your-project-id
SENTRY_ORG=your-organization-slug
SENTRY_PROJECT=instantmed
SENTRY_AUTH_TOKEN=your-auth-token

# -----------------------------------------------------------------------------
# Email Service - Resend (REQUIRED for notifications)
# -----------------------------------------------------------------------------
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY=re_...

# From email address (format: "Name <email@domain.com>")
# Must be from a verified domain in Resend
RESEND_FROM_EMAIL=InstantMed <noreply@instantmed.com.au>

# Webhook secret for delivery tracking (recommended for production)
# Get from Resend Dashboard > Webhooks > Create webhook for your domain
# URL should point to: https://yourdomain.com/api/webhooks/resend
RESEND_WEBHOOK_SECRET=whsec_...

# -----------------------------------------------------------------------------
# Internal API Security (REQUIRED)
# -----------------------------------------------------------------------------
# Generate a secure random string (minimum 32 characters)
# Example: openssl rand -base64 32
INTERNAL_API_SECRET=your-secure-random-string-here

# -----------------------------------------------------------------------------
# PHI Field Encryption (REQUIRED for production)
# -----------------------------------------------------------------------------
# AES-256-GCM encryption key for sensitive health information
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
# IMPORTANT: Store securely, losing this key = losing access to encrypted data
ENCRYPTION_KEY=your-32-byte-base64-encoded-key

# Envelope Encryption for PHI (intake_answers, drafts)
# Option A: Local master key (development/staging)
PHI_MASTER_KEY=your-32-byte-base64-encoded-key

# Option B: AWS KMS (production - recommended)
# AWS_KMS_KEY_ARN=arn:aws:kms:ap-southeast-2:xxx:key/xxx
# AWS_ACCESS_KEY_ID=xxx
# AWS_SECRET_ACCESS_KEY=xxx
# AWS_REGION=ap-southeast-2

# Feature flags for encryption rollout
PHI_ENCRYPTION_ENABLED=false
PHI_ENCRYPTION_WRITE_ENABLED=false
PHI_ENCRYPTION_READ_ENABLED=false

# -----------------------------------------------------------------------------
# Upstash Redis - Rate Limiting (OPTIONAL - recommended for production)
# -----------------------------------------------------------------------------
# Get these from: https://console.upstash.com/
UPSTASH_REDIS_REST_URL=https://your-endpoint.upstash.io
UPSTASH_REDIS_REST_TOKEN=your-token

# -----------------------------------------------------------------------------
# Feature Flags (OPTIONAL)
# -----------------------------------------------------------------------------
NEXT_PUBLIC_ENABLE_ANALYTICS=true
NEXT_PUBLIC_ENABLE_OCR=true

# -----------------------------------------------------------------------------
# Node Environment
# -----------------------------------------------------------------------------
# Use 'development' for local, 'production' for production
NODE_ENV=development

# -----------------------------------------------------------------------------
# PBS API - Medication Search (REQUIRED for medication search)
# -----------------------------------------------------------------------------
# Register for your own API key at: https://data-api.health.gov.au/
# The public demo key has severe rate limits (1 req/20s shared globally)
# For production, you should register for a dedicated key
PBS_API_KEY=your-pbs-api-key-here

# -----------------------------------------------------------------------------
# Additional Optional Services
# -----------------------------------------------------------------------------

# APITemplate.io (for alternative PDF generation if used)
# APITEMPLATE_API_KEY=your-api-key

# Google Analytics (if using)
# NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# PostHog Analytics (if using)
# NEXT_PUBLIC_POSTHOG_KEY=phc_...
# NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com
